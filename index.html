<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pokerole ProDex Ultimate</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    
    <style>
        /* Setup Font e Sfondo */
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #020617; 
            color: #f1f5f9;
            overflow-x: hidden;
        }

        /* Effetto Vetro (Glassmorphism) */
        .glass { 
            background: rgba(30, 41, 59, 0.7); 
            backdrop-filter: blur(12px); 
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08); 
        }

        /* Badge per i Tipi Pokémon */
        .type-pill {
            padding: 3px 10px;
            border-radius: 8px;
            font-size: 0.65rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        /* Palette Colori Tipi */
        .bg-drago { background-color: #7038f8; }
        .bg-buio { background-color: #705848; }
        .bg-coleottero { background-color: #a8b820; }
        .bg-normale { background-color: #a8a878; }
        .bg-fuoco { background-color: #f08030; }
        .bg-acqua { background-color: #6890f0; }
        .bg-erba { background-color: #78c850; }
        .bg-elettro { background-color: #f8d030; }
        .bg-psico { background-color: #f85888; }
        .bg-ghiaccio { background-color: #98d8d8; }
        .bg-lotta { background-color: #c03028; }
        .bg-veleno { background-color: #a040a0; }
        .bg-terra { background-color: #e0c068; }
        .bg-volante { background-color: #a890f0; }
        .bg-roccia { background-color: #b8a038; }
        .bg-spettro { background-color: #705898; }
        .bg-acciaio { background-color: #b8b8d0; }
        .bg-folletto { background-color: #ee99ac; }

        /* Animazioni */
        .card-anim { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .card-anim:hover { transform: translateY(-4px); box-shadow: 0 12px 24px -8px rgba(0,0,0,0.5); border-color: rgba(59, 130, 246, 0.5); }

        /* Scrollbar sottile */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: #020617; }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
    </style>
</head>
<body class="min-h-screen">

    <nav class="sticky top-0 z-50 glass border-b border-slate-800 px-4 py-3 mb-6">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <h1 class="text-xl font-black tracking-tighter text-blue-400">PRODEX <span class="text-slate-500 font-light">2026</span></h1>
            <div id="connection-status" class="flex items-center gap-2">
                <div class="w-2 h-2 rounded-full bg-yellow-500 animate-pulse"></div>
                <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Sincronizzazione...</span>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto px-4">
        
        <section class="glass rounded-3xl p-6 mb-8 shadow-2xl">
            <div class="relative mb-6">
                <input type="text" id="mainSearch" oninput="runSearch()" 
                    placeholder="Cerca per nome, tipo, effetto o parola chiave..." 
                    class="w-full bg-slate-900/80 border border-slate-700 rounded-2xl px-6 py-4 text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all">
            </div>

            <div class="flex flex-col md:flex-row gap-4 items-center">
                <div class="flex bg-slate-900/50 p-1 rounded-2xl w-full md:w-auto">
                    <button onclick="changeTab('pkmn')" id="tab-pkmn" class="flex-1 md:px-8 py-2 rounded-xl font-bold text-sm transition-all bg-blue-600 text-white">POKÉMON</button>
                    <button onclick="changeTab('tech')" id="tab-tech" class="flex-1 md:px-8 py-2 rounded-xl font-bold text-sm transition-all text-slate-400">TECNICHE</button>
                    <button onclick="changeTab('abil')" id="tab-abil" class="flex-1 md:px-8 py-2 rounded-xl font-bold text-sm transition-all text-slate-400">ABILITÀ</button>
                </div>
                
                <select id="rankFilter" onchange="runSearch()" class="w-full md:w-auto bg-slate-800 border border-slate-700 rounded-xl px-4 py-2 text-sm font-semibold outline-none focus:border-blue-500">
                    <option value="Tutti">Tutti i Ranghi</option>
                    <option value="Starter">Starter</option>
                    <option value="Scolaro">Scolaro</option>
                    <option value="Professionista">Professionista</option>
                    <option value="Asso">Asso</option>
                </select>
            </div>
        </section>

        <div class="flex items-center gap-4 mb-6 px-2 text-[10px] font-black uppercase tracking-widest text-slate-500">
            <span id="result-count">0 RISULTATI</span>
            <span class="h-px flex-1 bg-slate-800"></span>
        </div>

        <div id="display-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pb-20">
            </div>
    </main>

    <script>
        /**
         * LOGICA DI SISTEMA - POKEROLE PRODEX
         */
        
        // Stato Globale
        let DB = { pkmn: [], tech: [], abil: [] };
        let activeTab = 'pkmn';

        /**
         * Caricamento Dati con Fetch Robusto
         * Utilizziamo un timestamp per distruggere la cache sui telefoni
         */
        async function bootSystem() {
            const statusEl = document.getElementById('connection-status');
            
            try {
                const [pkmnData, techData, abilData] = await Promise.all([
                    fetch(`pokemon.json?nocache=${Date.now()}`).then(r => r.json()).catch(() => []),
                    fetch(`tecniche.json?nocache=${Date.now()}`).then(r => r.json()).catch(() => []),
                    fetch(`abilita.json?nocache=${Date.now()}`).then(r => r.json()).catch(() => [])
                ]);

                DB.pkmn = pkmnData;
                DB.tech = techData;
                DB.abil = abilData;

                statusEl.innerHTML = `<div class="w-2 h-2 rounded-full bg-emerald-500"></div><span class="text-[10px] font-bold text-emerald-500 uppercase tracking-widest">Sistema Online</span>`;
                
                runSearch(); // Primo avvio
            } catch (err) {
                console.error("Errore boot:", err);
                statusEl.innerHTML = `<div class="w-2 h-2 rounded-full bg-red-500"></div><span class="text-[10px] font-bold text-red-500 uppercase tracking-widest">Errore Database</span>`;
            }
        }

        /**
         * Gestione Cambio Tab (Pokemon / Tecniche / Abilità)
         */
        function changeTab(tab) {
            activeTab = tab;
            // Aggiorna UI Bottoni
            document.querySelectorAll('[id^="tab-"]').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'text-white');
                btn.classList.add('text-slate-400');
            });
            const activeBtn = document.getElementById(`tab-${tab}`);
            activeBtn.classList.add('bg-blue-600', 'text-white');
            activeBtn.classList.remove('text-slate-400');

            // Mostra/Nascondi filtro rango (utile solo per Pokemon)
            document.getElementById('rankFilter').style.display = (tab === 'pkmn') ? 'block' : 'none';
            
            runSearch();
        }

        /**
         * Motore di Ricerca "Deep Search"
         */
        function runSearch() {
            const term = document.getElementById('mainSearch').value.toLowerCase();
            const rank = document.getElementById('rankFilter').value;
            const container = document.getElementById('display-grid');
            const data = DB[activeTab];

            const filtered = data.filter(item => {
                // Trasforma l'intero oggetto in stringa per cercare in ogni campo (nome, descrizione, tipo, etc)
                const searchSpace = JSON.stringify(item).toLowerCase();
                const matchesSearch = searchSpace.includes(term);
                
                if (activeTab === 'pkmn' && rank !== 'Tutti') {
                    return matchesSearch && item.rango === rank;
                }
                return matchesSearch;
            });

            document.getElementById('result-count').innerText = `${filtered.length} ${activeTab} TROVATI`;
            
            // Rendering HTML
            container.innerHTML = filtered.map(item => {
                if (activeTab === 'pkmn') return renderPkmn(item);
                if (activeTab === 'tech') return renderTech(item);
                return renderAbil(item);
            }).join('');
        }

        // --- TEMPLATE CARD ---

        function renderPkmn(p) {
            return `
                <div class="glass p-6 rounded-3xl card-anim border-t-2 border-blue-500/50">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-black uppercase tracking-tighter">${p.nome}</h3>
                        <span class="text-[9px] font-bold px-2 py-1 bg-white/5 rounded-lg border border-white/10">${p.rango}</span>
                    </div>
                    <div class="space-y-2">
                        <div class="flex items-center gap-2">
                            <span class="text-slate-500 text-[10px] font-bold uppercase">Tipo:</span>
                            <span class="text-sm font-medium">${p.tipo}</span>
                        </div>
                        <div class="bg-slate-900/50 p-3 rounded-xl border border-white/5">
                            <span class="text-[9px] text-slate-500 font-bold uppercase block mb-1">Attributi</span>
                            <span class="text-xs leading-relaxed text-blue-100">${p.attributi || 'Non definiti'}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderTech(t) {
            const typeKey = t.tipo ? t.tipo.toLowerCase().trim() : 'normale';
            const desc = t.descrizione || t.description || "Nessuna descrizione.";
            const keywords = t.parole_chiave || [];

            return `
                <div class="glass p-6 rounded-3xl card-anim border-l-4 border-slate-700">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold">${t.nome}</h3>
                        <span class="type-pill bg-${typeKey}">${t.tipo}</span>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-2 mb-4 text-center">
                        <div class="bg-slate-900/80 p-2 rounded-xl">
                            <span class="text-[8px] text-slate-500 uppercase block">Accuratezza</span>
                            <span class="text-xs font-bold text-blue-300">${t.accuratezza}</span>
                        </div>
                        <div class="bg-slate-900/80 p-2 rounded-xl">
                            <span class="text-[8px] text-slate-500 uppercase block">Danno</span>
                            <span class="text-xs font-bold text-red-400">${t.pool_danno}</span>
                        </div>
                    </div>

                    <p class="text-sm text-slate-300 italic mb-4 leading-snug">"${desc}"</p>
                    
                    <div class="bg-blue-500/5 p-3 rounded-xl border border-blue-500/10 mb-4">
                        <span class="text-[9px] text-blue-400 font-black uppercase block mb-1">Effetto Speciale</span>
                        <p class="text-[11px] leading-normal text-slate-200">${t.effetti_aggiuntivi}</p>
                    </div>

                    <div class="flex flex-wrap gap-1">
                        ${keywords.map(k => `<span class="text-[8px] bg-slate-800 text-slate-500 px-2 py-0.5 rounded-md font-bold uppercase">#${k}</span>`).join('')}
                    </div>
                </div>
            `;
        }

        function renderAbil(a) {
            const desc = a.effetto || a.descrizione || "Dettagli non disponibili.";
            return `
                <div class="glass p-6 rounded-3xl card-anim border-b-2 border-emerald-500/50">
                    <h3 class="text-lg font-black uppercase tracking-tight text-emerald-400 mb-3">${a.nome}</h3>
                    <p class="text-sm text-slate-300 leading-relaxed">${desc}</p>
                </div>
            `;
        }

        // Avvio Applicazione
        window.addEventListener('DOMContentLoaded', bootSystem);
    </script>
</body>
</html>
