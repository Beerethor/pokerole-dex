window.openDetail = (type, name) => {
    // Cerca l'oggetto corrispondente nel database (es. tecniche.json)
    const entry = window.dataStore[type].find(i => (i.nome || i).toLowerCase() === name.toLowerCase());
    const body = document.getElementById('modalBody');

    if (!entry) {
        body.innerHTML = `<p class="text-red-500">Errore: Record non trovato nel database ${type}.</p>`;
        document.getElementById('infoModal').style.display = 'flex';
        return;
    }

    // Estrazione dati specifica per le TECNICHE
    if (type === 'tecniche') {
        const nome = entry.nome || "Sconosciuto";
        const tipo = entry.tipo || "Normale";
        const categoria = entry.categoria || "Fisico"; // Es. Fisico, Speciale, Stato
        const accuratezza = entry.accuratezza || entry.accuracy || "-";
        const pool_danno = entry.pool_danno || entry.danno || entry.damage || "-";
        const descrizione = entry.descrizione || "Nessun log descrittivo disponibile.";
        const effetti_aggiuntivi = entry.effetti_aggiuntivi || entry.effetto || "Nessun effetto aggiuntivo rilevato.";

        body.innerHTML = `
            <div class="flex justify-between items-center mb-6 border-b border-white/10 pb-4">
                <div>
                    <span class="text-cyan-500 font-bold text-[10px] uppercase tracking-widest">DATA RECORD: ${categoria}</span>
                    <h2 class="text-4xl font-black font-[Orbitron] uppercase italic text-white">${nome}</h2>
                </div>
                <div class="text-right">
                    <span class="type-tag type-${tipo.toLowerCase()}">${tipo}</span>
                </div>
            </div>
            
            <div class="space-y-6">
                <div>
                    <span class="data-label">DESCRIZIONE</span>
                    <div class="bg-black/60 p-5 rounded-2xl border border-white/5 text-sm text-slate-300 leading-relaxed mt-1">
                        "${descrizione}"
                    </div>
                </div>

                <div>
                    <span class="data-label">EFFETTI AGGIUNTIVI</span>
                    <div class="bg-cyan-900/20 p-5 rounded-2xl border border-cyan-500/30 text-sm text-cyan-100 italic mt-1 shadow-inner">
                        ${effetti_aggiuntivi}
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-black/80 p-5 rounded-3xl border border-white/10 text-center">
                        <span class="data-label">ACCURATEZZA</span><br>
                        <span class="text-xl font-black text-white uppercase mt-1 block">${accuratezza}</span>
                    </div>
                    <div class="bg-black/80 p-5 rounded-3xl border border-white/10 text-center">
                        <span class="data-label">POOL DANNO</span><br>
                        <span class="text-xl font-black text-red-500 uppercase mt-1 block">${pool_danno}</span>
                    </div>
                </div>
            </div>
        `;
    } else {
        // Fallback per ABILITÃ€ o altro
        body.innerHTML = `
            <span class="text-cyan-500 font-bold text-[10px] uppercase tracking-widest">${type} record</span>
            <h2 class="text-3xl font-black font-[Orbitron] uppercase text-white mb-6">${entry.nome || name}</h2>
            <div class="bg-black/60 p-6 rounded-2xl border border-white/10 italic text-slate-300 text-sm">
                "${entry.effetto || entry.descrizione || 'Nessun dato.'}"
            </div>
        `;
    }
    
    document.getElementById('infoModal').style.display = 'flex';
};
